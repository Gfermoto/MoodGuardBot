[{"id":"3cbc8b1834450790","type":"function","z":"fb630e69370bdf1d","name":"–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞","func":"try {\n    const response = JSON.parse(msg.payload);\n    const labels = response[0]; // –ü–æ–ª—É—á–∞–µ–º –º–∞—Å—Å–∏–≤ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞\n\n    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤\n    let positive = 0;\n    let neutral = 0;\n    let negative = 0;\n\n    // –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –∏ —Å—É–º–º–∏—Ä—É–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç—ã\n    labels.forEach(label => {\n        if (label.label === 'positive') {\n            positive = (label.score * 100).toFixed(2);\n        } else if (label.label === 'neutral') {\n            neutral = (label.score * 100).toFixed(2);\n        } else if (label.label === 'negative') {\n            negative = (label.score * 100).toFixed(2);\n        }\n    });\n\n    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å–ª–∏ –Ω–µ–≥–∞—Ç–∏–≤ –±–æ–ª—å—à–µ 70%\n    if (negative > 70) {\n        // –ü–æ–ª—É—á–∞–µ–º username –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\n        const username = msg.originalMessage.from.username || \"–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å\";\n\n        // –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º, username –∏ —Å–æ—Å—Ç–∞–≤–æ–º –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã\n        const message = `üö® –í–Ω–∏–º–∞–Ω–∏–µ! –í —á–∞—Ç–µ –¥—É—à–Ω–æ!\\n\\n` +\n            `üë§ –í–æ–∑–¥—É—Ö –∏—Å–ø–æ—Ä—Ç–∏–ª: @${username}\\n\\n` +\n            `–°–æ—Å—Ç–∞–≤ –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã:\\n` +\n            `üòä –ü–æ–∑–∏—Ç–∏–≤: ${positive}%\\n` +\n            `üòê –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ: ${neutral}%\\n` +\n            `üò† –ù–µ–≥–∞—Ç–∏–≤: ${negative}%`;\n\n        const original = msg.originalMessage;\n\n        return {\n            payload: {\n                type: \"message\",\n                chatId: original.chat.id,\n                content: message,\n                message_thread_id: original.message_thread_id,\n\n                // –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ—Ç–≤–µ—Ç–∞\n                reply_parameters: {\n                    message_id: original.message_id,\n                    chat_id: original.chat.id,\n                    allow_sending_without_reply: true\n                }\n            }\n        };\n    } else {\n        // –ï—Å–ª–∏ –Ω–µ–≥–∞—Ç–∏–≤ –º–µ–Ω—å—à–µ 70%, –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ\n        return null;\n    }\n} catch (e) {\n    node.error(\"–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è:\", e);\n}\nreturn null;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":300,"wires":[["d6785d7f573a1c6a"]]}]
